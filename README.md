# Stock Buddy

株式投資初心者向けのAI投資アシスタントサービス。

## コンセプト

### キャッチコピー

**任せて学んで、一緒に増やす**

AIに判断を任せながら、理由を理解できる投資。

### ターゲットユーザー

**投資初心者〜トレーダー志望 - 「学びながら成長したい」人**

- 投資に興味があり、これからトレードしていきたい
- 専門用語も含めて投資の知識を身につけたい
- 実践的なスキルを段階的に学びたい
- リスクを理解した上で自分で判断できるようになりたい

### コアバリュー

| 価値 | 説明 |
|------|------|
| 🤝 **寄り添う** | AIコーチが毎日優しく声をかける。専門用語には必ず解説を添える |
| 📚 **学べる** | テクニカル分析（チャートパターン、RSI、MACDなど）を解説付きで提供。使いながら投資知識が自然と身につく |
| ✨ **シンプル** | 質問は最小限（予算と期間だけ）。選択肢を増やして迷わせない |
| 🛡️ **安心** | シミュレーション機能で練習できる。5銘柄までの制限でリスクを管理 |

### サービスの特徴

- **お任せ感**: 予算と投資期間を入れるだけで、AIが最適な銘柄を提案
- **初心者向けスコア**: 値動きの安定性や流動性を考慮した独自スコアで優良銘柄を選定
- **学習サポート**: 専門用語を使いつつ、その意味と評価を分かりやすく表示
- **段階的な実践**: シミュレーション → ウォッチリスト → 実際の購入と段階的に進められる

### 設計思想

#### ❌ やってはいけないこと
- 専門用語を解説なしで使う（用語には必ず説明を添える）
- 選択肢を増やす（銘柄数、リスク許容度の詳細など）
- ユーザーに判断を委ねすぎる
- 複雑な機能を追加する

#### ✅ やるべきこと
- 専門用語＋分かりやすい解説をセットで提供（例:「ダブルボトム（2回底を打って反転する買いパターン）」）
- 自動で最適な提案をする（予算と期間から銘柄数を決定）
- テクニカル分析の結果を初心者が理解できる形で表示
- 迷わせない導線設計
- シンプルで分かりやすいUI

#### 初心者向けの定義

**初心者向け ≠ 難しい言葉や論理を避ける**

- ✅ 複雑な指標も入れつつ、わかりやすく提示する
- ✅ 専門用語を使い、その意味と評価を添える
- ✅ 使いながら自然と専門用語を覚えていける設計

**表示形式の例:**
```
シャープレシオ: 1.2
（リスクに対するリターンの効率。1以上で優秀）
→ あなたのポートフォリオは効率よくリターンを得ています
```

1. **指標名** - 専門用語そのまま
2. **解説** - その指標が何を意味するか
3. **評価** - 良い/普通/注意など
4. **アクション** - 次に何をすべきか

### 機能方針

#### オンボーディング
- 質問は2つだけ（予算・期間）
- 銘柄数は自動決定（初心者が迷わないように）
- 提案は3択（実際に購入/シミュレーション/ウォッチリスト）

#### AI提案ロジック
- 投資期間に応じた分散投資
  - 長期: 4-5銘柄（リスク分散重視）
  - 中期: 3-4銘柄（バランス）
  - 短期: 2-3銘柄（機動性重視）
- 予算内で購入可能な銘柄から高スコア順に選択
- 初心者向けスコアを重視

#### 制限設計
- ポートフォリオ: 最大5銘柄
- ウォッチリスト: 最大5銘柄
- 理由: 初心者が管理しやすい範囲に制限

### デザインイメージ

- **トーン**: 親しみやすい、信頼感のある、落ち着いた
- **カラー**: 信頼・安定を表すブルー系をベースに、成長・上昇を表すグリーンをアクセント
- **イメージ**: 初心者に寄り添うコーチ、一緒に成長するパートナー
- **アイコン**: 上昇チャート + 本（学習）を組み合わせたデザイン

## 技術スタック

- **Frontend/Backend**: Next.js 14 (App Router), TypeScript, TailwindCSS
- **認証**: NextAuth.js (Google OAuth)
- **Database**: PostgreSQL (Prisma ORM)
- **AI**: OpenAI GPT-4
- **株価データ**: yfinance (Python)
- **技術指標**: technicalindicators (npm)
- **インフラ**: Railway

## セットアップ

### 1. 環境変数の設定

`.env.example`をコピーして`.env`を作成し、必要な値を設定します。

```bash
cp .env.example .env
```

### 2. データベースのセットアップ

Railwayで PostgreSQLデータベースを作成し、接続URLを`.env`の`DATABASE_URL`に設定します。

### 3. 依存パッケージのインストール

```bash
# Node.js パッケージ
npm install

# Python パッケージ
pip install -r scripts/requirements.txt
```

### 4. Prisma マイグレーション

```bash
npx prisma migrate dev --name init
npx prisma generate
```

### 5. 初期データ投入

```bash
python scripts/init_data.py
```

### 6. 開発サーバーの起動

```bash
npm run dev
```

http://localhost:3000 でアプリケーションにアクセスできます。

## プロジェクト構成

```
stock-buddy/
├─ app/                    # Next.js App Router
│  ├─ (auth)/             # 認証関連ページ
│  ├─ dashboard/          # ダッシュボード
│  ├─ portfolio/          # ポートフォリオ
│  └─ api/                # API Routes
├─ components/            # Reactコンポーネント
├─ lib/                   # ユーティリティ
├─ prisma/                # Prisma schema & migrations
├─ scripts/               # Pythonスクリプト
└─ docs/                  # ドキュメント
```

## バッチ処理スケジュール

GitHub Actionsで以下のバッチ処理を自動実行しています（時刻はJST）。

### 取引時間に合わせた処理（平日のみ）

| バッチ | スケジュール | 説明 |
|--------|-------------|------|
| 注目銘柄更新 | 8:00 / 12:30 / 15:35 | 今日の注目銘柄、あなたへのおすすめを更新 |
| 株価分析 | 8:00 / 10:30 / 12:30 / 14:00 / 15:30 | ポートフォリオ分析・購入レコメンドを更新 |
| 価格アラート | 9:00-15:30（15分間隔） | 設定した価格条件をチェックして通知 |
| 取引時間通知 | 9:00 / 15:30 | 取引開始・終了をプッシュ通知 |
| 判定評価 | 16:00 | 過去の予測結果を実績と照合 |

### 定期バッチ

| バッチ | スケジュール | 説明 |
|--------|-------------|------|
| ニュース取得 | 7:30（毎日）/ 12:00（平日） | 日本・米国の株式ニュースを取得 |
| 決算情報取得 | 6:00（毎日） | 銘柄の決算情報を取得 |
| OpenAI使用量チェック | 10:00（毎日） | API使用量を監視 |
| 週次レポート | 9:00（毎週日曜） | 週間の推奨結果をレポート |
| 古いデータ削除 | 3:00（毎週日曜） | 不要な過去データをクリーンアップ |
| JPX銘柄更新 | 10:00（毎週月曜） | 上場銘柄マスタを更新 |
| JPXマスタ同期 | 9:00（毎月1日） | JPX公式データと同期 |

## スクリプト

### 初期データ投入

```bash
python scripts/init_data.py
```

主要銘柄を登録し、過去2年分の株価データを取得します。

## デプロイ（Railway）

1. Railwayプロジェクトを作成
2. PostgreSQLサービスを追加
3. Next.jsサービスを追加
4. Cron Jobを設定（毎日17:00 JST = 08:00 UTC）
   - スケジュール: `0 8 * * *`
   - コマンド: `cd /app && python scripts/fetch_stocks.py`
5. 環境変数を設定

## ドキュメント

- [仕様書](docs/specification.md)
- [設計書](docs/plans/2026-01-27-stockbuddy-design.md)

## ライセンス

Private
